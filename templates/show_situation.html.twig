<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>メンバー一覧</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/show_situation.css">
</head>
<body>
    <div class="header">
        <h1>{{ trigger_name }}</h1>
        <div class="navigation">
            <a href="/show_trigger" class="back-button">
                <i class="fas fa-arrow-left mr-2"></i> 戻る
            </a>
        </div>
    </div>

    {% for situation in situations %}
        <div class="one_situation_container">
            <form method="get" action="/show_message" class="situation_show_form">
                <input type="hidden" name="trigger_id" value="{{trigger_id}}">
                <input type="hidden" name="situation_id" value="{{situation.id}}">
                <button type="submit" class="situation_show_button">{{ situation.situation_name }}</button>
            </form>
            <div class="button-group">
                <form method="get" action="/edit_message" class="situation_edit_button">
                    <input type="hidden" name="situation_id" value="{{situation.id}}">
                    <input type="hidden" name="trigger_id" value="{{trigger_id}}">
                    <button type="submit" class="situation_edit_button">
                        <i class="fas fa-edit edit-icon"></i>
                        追加-編集
                    </button>
                </form>
                <form method="post" action="/delete_situation" class="situation_edit_button" onsubmit="return confirm('「{{ situation.situation_name }}」に登録した全てのメッセージが削除されます。\n本当に削除しますか？');">
                    <input type="hidden" name="situation_id" value="{{situation.id}}">
                    <input type="hidden" name="trigger_id" value="{{trigger_id}}">
                    <button type="submit" class="situation_edit_button">
                        <i class="fas fa-trash delete-icon"></i>
                    </button>
                </form>
            </div>
        </div>
    {% endfor %}

    <form method="get" action="/edit_situation_name" class="edit_name_container">
        <input type="hidden" name="trigger_id" value="{{trigger_id}}">
        <button type="submit" class="situation_edit_button">
            <i class="fas fa-cog"></i>
            名前を編集する
        </button>
    </form>

    <div class="new-situation-form">
        <h2>新規メンバー追加</h2>
        <form method="post" action="/add_situation_exec" class="form-group">
            <input
                type="text"
                name="add_situation_name"
                placeholder="新しい人物名を入力"
                value="{% if old_input.add_situation_name is defined %}{{ old_input.add_situation_name }}{% endif %}"
                class="{% if validation_errors.add_situation_name is defined %}error{% endif %}"
                required
            >
            {% if validation_errors.add_situation_name is defined %}
                <span class="error-message">{{ validation_errors.add_situation_name|first }}</span>
            {% endif %}
            <input type="hidden" name="trigger_id" value="{{ trigger_id }}">
            <button type="submit" class="add-button">
                <i class="fas fa-plus"></i>
                追加
            </button>
        </form>
    </div>
</body>
</html>
